{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "# Evaluation\n",
    "# • Aggregate the files into one dataframe using glob\n",
    "# • Create columns for the following - Day, Week\n",
    "# • Create a column for Terminal ID  - This should only take the last 8 characters of the reference column and \n",
    "# for only columns where the adapter is postilion\n",
    "# • Plot the distribution of the transaction amount column\n",
    "# • Run a pivot_table on the data provided and show how performance changed on a daily and weekly basis\n",
    "# For the charts that you plot, you should stick with one colour as the colour doesn’t tell any additional information.\n",
    "# Plot the histogram and make it a decent chart size\n",
    "# Regarding the pivot_table, you can go with the intent  and adapter  columns and provide summary information\n",
    "# Like how much in each intent on a weekly basis and then the following:\n",
    "# • Sum\n",
    "# • Median\n",
    "# • Mean\n",
    "# • Count\n",
    "# • Max\n",
    "# • Min\n",
    "# All of these can be done using the aggfunc for ease\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "from glob import glob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['gomoneytr/Transactions Report-20201214-20201215.csv',\n",
       " 'gomoneytr/Transactions Report-20201215-20201216.csv',\n",
       " 'gomoneytr/Transactions Report-20201216-20201217.csv',\n",
       " 'gomoneytr/Transactions Report-20201217-20201218.csv',\n",
       " 'gomoneytr/Transactions Report-20201219-20201220.csv']"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# • Aggregate the files into one dataframe using glob\n",
    "#new_tr = new_transactions report\n",
    "new_tr = sorted(glob(\"gomoneytr/Transactions Report-2020*.csv\"))\n",
    "new_tr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 510,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Ref No.</th>\n",
       "      <th>Outwards Transfer Ref No.</th>\n",
       "      <th>Currency</th>\n",
       "      <th>Amount</th>\n",
       "      <th>Ecosystem</th>\n",
       "      <th>Sender Full Name</th>\n",
       "      <th>Sender Category</th>\n",
       "      <th>Sender Phone Number</th>\n",
       "      <th>Sender Wallet Balance</th>\n",
       "      <th>...</th>\n",
       "      <th>Description</th>\n",
       "      <th>Source</th>\n",
       "      <th>Destination</th>\n",
       "      <th>Adapter</th>\n",
       "      <th>Transfer Transaction ID</th>\n",
       "      <th>NIP Payment Refernce</th>\n",
       "      <th>Sender Channel</th>\n",
       "      <th>Recipient Channel</th>\n",
       "      <th>Day</th>\n",
       "      <th>Week</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-12-14T23:08:47.732Z</td>\n",
       "      <td>000013201215000828000291599394</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>16000.00</td>\n",
       "      <td>Credit</td>\n",
       "      <td>Adesiji Temidire Tioluwani</td>\n",
       "      <td>transfers</td>\n",
       "      <td>0449794934</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank transfer from ADESIJI TEMIDIRE TIOLUWANIN...</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Nip</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-12-14T23:10:04.916Z</td>\n",
       "      <td>00533076121331533076acq04766</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>1.04</td>\n",
       "      <td>Ecosystem</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>...</td>\n",
       "      <td>Pre-authorization Reversal</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-12-14T23:13:44.869Z</td>\n",
       "      <td>000013201215001301000291600553</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>1000.00</td>\n",
       "      <td>Credit</td>\n",
       "      <td>Adesiji Temidire Tioluwani</td>\n",
       "      <td>transfers</td>\n",
       "      <td>0449794934</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank transfer from ADESIJI TEMIDIRE TIOLUWANIN...</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Nip</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-12-14T23:13:56.890Z</td>\n",
       "      <td>100022201215121415354388202248</td>\n",
       "      <td>ld_244e2141-51ef-4f69-a97e-ad5adf791128</td>\n",
       "      <td>NGN</td>\n",
       "      <td>300008.50</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Aliu Lawal</td>\n",
       "      <td>transfers</td>\n",
       "      <td>07037135181</td>\n",
       "      <td>14748705</td>\n",
       "      <td>...</td>\n",
       "      <td>Transfer to LAWAL ALIU BOLADE</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Nip</td>\n",
       "      <td>100022201215121415354388202248</td>\n",
       "      <td>nip_6057f88b-0833-40d0-816f-857166842f46</td>\n",
       "      <td>farepay</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-12-14T23:14:39.694Z</td>\n",
       "      <td>100022201215121457311664802525</td>\n",
       "      <td>ld_bc93cfb2-8190-4aac-a743-c9f7c3e03326</td>\n",
       "      <td>NGN</td>\n",
       "      <td>98.50</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Abubakar Abdullahi</td>\n",
       "      <td>enjoyment</td>\n",
       "      <td>07066516458</td>\n",
       "      <td>150</td>\n",
       "      <td>...</td>\n",
       "      <td>Transfer to ABDULLAHI ABUBAKAR</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Nip</td>\n",
       "      <td>100022201215121457311664802525</td>\n",
       "      <td>nip_9d16c036-a3a1-43e0-ab59-ad3900f4bc38</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6306</th>\n",
       "      <td>2020-12-20T22:52:28.607Z</td>\n",
       "      <td>00374830035522374830MDTERM</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>406.12</td>\n",
       "      <td>Ecosystem</td>\n",
       "      <td>Funmilayo Ayannuga</td>\n",
       "      <td>card purchase</td>\n",
       "      <td>07062389980</td>\n",
       "      <td>987563</td>\n",
       "      <td>...</td>\n",
       "      <td>Pre-authorization</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6307</th>\n",
       "      <td>2020-12-20T22:52:36.673Z</td>\n",
       "      <td>00153588035522153588MDTERM</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>7676.40</td>\n",
       "      <td>Ecosystem</td>\n",
       "      <td>Funmilayo Ayannuga</td>\n",
       "      <td>card purchase</td>\n",
       "      <td>07062389980</td>\n",
       "      <td>219923</td>\n",
       "      <td>...</td>\n",
       "      <td>Pre-authorization</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6308</th>\n",
       "      <td>2020-12-20T22:52:38.808Z</td>\n",
       "      <td>100022201220115258125005602044</td>\n",
       "      <td>ld_528d842a-97c0-4724-96fa-3a41cbf56e50</td>\n",
       "      <td>NGN</td>\n",
       "      <td>2508.50</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Abubakar Danladi</td>\n",
       "      <td>transfers</td>\n",
       "      <td>09035000899</td>\n",
       "      <td>268000</td>\n",
       "      <td>...</td>\n",
       "      <td>Transfer to KHADIJA SABO MIJINYAWA</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Nip</td>\n",
       "      <td>100022201220115258125005602044</td>\n",
       "      <td>nip_2182fa19-f464-4b60-8bdf-e90075d17343</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6309</th>\n",
       "      <td>2020-12-20T22:52:42.852Z</td>\n",
       "      <td>00374830035522374830mdterm</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>1.00</td>\n",
       "      <td>Ecosystem</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>...</td>\n",
       "      <td>Pre-authorization Reversal</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6310</th>\n",
       "      <td>2020-12-20T22:54:40.407Z</td>\n",
       "      <td>000013201220235445000300799075</td>\n",
       "      <td>-</td>\n",
       "      <td>NGN</td>\n",
       "      <td>100.00</td>\n",
       "      <td>Credit</td>\n",
       "      <td>Adamu Zubairu Saidu</td>\n",
       "      <td>transfers</td>\n",
       "      <td>0152407729</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank transfer from ADAMU ZUBAIRU SAIDUVia GTWORLD</td>\n",
       "      <td>Bank Account</td>\n",
       "      <td>Wallet</td>\n",
       "      <td>Nip</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>gomoney</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6311 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                          Date                         Ref No.  \\\n",
       "0     2020-12-14T23:08:47.732Z  000013201215000828000291599394   \n",
       "1     2020-12-14T23:10:04.916Z    00533076121331533076acq04766   \n",
       "2     2020-12-14T23:13:44.869Z  000013201215001301000291600553   \n",
       "3     2020-12-14T23:13:56.890Z  100022201215121415354388202248   \n",
       "4     2020-12-14T23:14:39.694Z  100022201215121457311664802525   \n",
       "...                        ...                             ...   \n",
       "6306  2020-12-20T22:52:28.607Z      00374830035522374830MDTERM   \n",
       "6307  2020-12-20T22:52:36.673Z      00153588035522153588MDTERM   \n",
       "6308  2020-12-20T22:52:38.808Z  100022201220115258125005602044   \n",
       "6309  2020-12-20T22:52:42.852Z      00374830035522374830mdterm   \n",
       "6310  2020-12-20T22:54:40.407Z  000013201220235445000300799075   \n",
       "\n",
       "                    Outwards Transfer Ref No. Currency     Amount  Ecosystem  \\\n",
       "0                                           -      NGN   16000.00     Credit   \n",
       "1                                           -      NGN       1.04  Ecosystem   \n",
       "2                                           -      NGN    1000.00     Credit   \n",
       "3     ld_244e2141-51ef-4f69-a97e-ad5adf791128      NGN  300008.50      Debit   \n",
       "4     ld_bc93cfb2-8190-4aac-a743-c9f7c3e03326      NGN      98.50      Debit   \n",
       "...                                       ...      ...        ...        ...   \n",
       "6306                                        -      NGN     406.12  Ecosystem   \n",
       "6307                                        -      NGN    7676.40  Ecosystem   \n",
       "6308  ld_528d842a-97c0-4724-96fa-3a41cbf56e50      NGN    2508.50      Debit   \n",
       "6309                                        -      NGN       1.00  Ecosystem   \n",
       "6310                                        -      NGN     100.00     Credit   \n",
       "\n",
       "                Sender Full Name Sender Category Sender Phone Number  \\\n",
       "0     Adesiji Temidire Tioluwani       transfers          0449794934   \n",
       "1                              -               -                   -   \n",
       "2     Adesiji Temidire Tioluwani       transfers          0449794934   \n",
       "3                     Aliu Lawal       transfers         07037135181   \n",
       "4             Abubakar Abdullahi       enjoyment         07066516458   \n",
       "...                          ...             ...                 ...   \n",
       "6306          Funmilayo Ayannuga   card purchase         07062389980   \n",
       "6307          Funmilayo Ayannuga   card purchase         07062389980   \n",
       "6308            Abubakar Danladi       transfers         09035000899   \n",
       "6309                           -               -                   -   \n",
       "6310         Adamu Zubairu Saidu       transfers          0152407729   \n",
       "\n",
       "     Sender Wallet Balance  ...  \\\n",
       "0                        0  ...   \n",
       "1                        -  ...   \n",
       "2                        0  ...   \n",
       "3                 14748705  ...   \n",
       "4                      150  ...   \n",
       "...                    ...  ...   \n",
       "6306                987563  ...   \n",
       "6307                219923  ...   \n",
       "6308                268000  ...   \n",
       "6309                     -  ...   \n",
       "6310                     0  ...   \n",
       "\n",
       "                                            Description        Source  \\\n",
       "0     Bank transfer from ADESIJI TEMIDIRE TIOLUWANIN...  Bank Account   \n",
       "1                            Pre-authorization Reversal     Postilion   \n",
       "2     Bank transfer from ADESIJI TEMIDIRE TIOLUWANIN...  Bank Account   \n",
       "3                         Transfer to LAWAL ALIU BOLADE        Wallet   \n",
       "4                        Transfer to ABDULLAHI ABUBAKAR        Wallet   \n",
       "...                                                 ...           ...   \n",
       "6306                                  Pre-authorization        Wallet   \n",
       "6307                                  Pre-authorization        Wallet   \n",
       "6308                 Transfer to KHADIJA SABO MIJINYAWA        Wallet   \n",
       "6309                         Pre-authorization Reversal     Postilion   \n",
       "6310  Bank transfer from ADAMU ZUBAIRU SAIDUVia GTWORLD  Bank Account   \n",
       "\n",
       "       Destination    Adapter         Transfer Transaction ID  \\\n",
       "0           Wallet        Nip                               -   \n",
       "1           Wallet  Postilion                               -   \n",
       "2           Wallet        Nip                               -   \n",
       "3     Bank Account        Nip  100022201215121415354388202248   \n",
       "4     Bank Account        Nip  100022201215121457311664802525   \n",
       "...            ...        ...                             ...   \n",
       "6306     Postilion  Postilion                               -   \n",
       "6307     Postilion  Postilion                               -   \n",
       "6308  Bank Account        Nip  100022201220115258125005602044   \n",
       "6309        Wallet  Postilion                               -   \n",
       "6310        Wallet        Nip                               -   \n",
       "\n",
       "                          NIP Payment Refernce Sender Channel  \\\n",
       "0                                            -        gomoney   \n",
       "1                                            -        gomoney   \n",
       "2                                            -        gomoney   \n",
       "3     nip_6057f88b-0833-40d0-816f-857166842f46        farepay   \n",
       "4     nip_9d16c036-a3a1-43e0-ab59-ad3900f4bc38        gomoney   \n",
       "...                                        ...            ...   \n",
       "6306                                         -        gomoney   \n",
       "6307                                         -        gomoney   \n",
       "6308  nip_2182fa19-f464-4b60-8bdf-e90075d17343        gomoney   \n",
       "6309                                         -        gomoney   \n",
       "6310                                         -        gomoney   \n",
       "\n",
       "     Recipient Channel Day Week  \n",
       "0              gomoney   0    0  \n",
       "1              gomoney   0    0  \n",
       "2              gomoney   0    0  \n",
       "3              gomoney   0    0  \n",
       "4              gomoney   0    0  \n",
       "...                ...  ..  ...  \n",
       "6306           gomoney   0    0  \n",
       "6307           gomoney   0    0  \n",
       "6308           gomoney   0    0  \n",
       "6309           gomoney   0    0  \n",
       "6310           gomoney   0    0  \n",
       "\n",
       "[6311 rows x 27 columns]"
      ]
     },
     "execution_count": 510,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# • Create columns for the following - Day, Week \n",
    "new_tr1 = pd.concat((pd.read_csv(file).assign(Day = 0, Week = 0)\n",
    "                     for file in new_tr), ignore_index = True)\n",
    "new_tr1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 511,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Ref No.</th>\n",
       "      <th>Adapter</th>\n",
       "      <th>Terminal ID</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6306</th>\n",
       "      <td>00374830035522374830MDTERM</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>00374830035522374830MDTERMPostilion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6307</th>\n",
       "      <td>00153588035522153588MDTERM</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>00153588035522153588MDTERMPostilion</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6309</th>\n",
       "      <td>00374830035522374830mdterm</td>\n",
       "      <td>Postilion</td>\n",
       "      <td>00374830035522374830mdtermPostilion</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                         Ref No.    Adapter  \\\n",
       "6306  00374830035522374830MDTERM  Postilion   \n",
       "6307  00153588035522153588MDTERM  Postilion   \n",
       "6309  00374830035522374830mdterm  Postilion   \n",
       "\n",
       "                              Terminal ID  \n",
       "6306  00374830035522374830MDTERMPostilion  \n",
       "6307  00153588035522153588MDTERMPostilion  \n",
       "6309  00374830035522374830mdtermPostilion  "
      ]
     },
     "execution_count": 511,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# • Create a column for Terminal ID  - This should only take the last 8 characters of the reference column and \n",
    "# for only columns where the adapter is postilion\n",
    "new_tr1[\"Terminal ID\"] = new_tr1[\"Ref No.\"] + new_tr1[\"Adapter\"]\n",
    "new_tr2 = new_tr1[[\"Ref No.\", \"Adapter\", \"Terminal ID\"]]\n",
    "new_tr3 = new_tr2.iloc[-8:]\n",
    "new_tr4 = new_tr3[new_tr3[\"Adapter\"] == \"Postilion\"]\n",
    "new_tr4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 543,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5, 1.0, 'Transaction Report 14-20')"
      ]
     },
     "execution_count": 543,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "# • Plot the distribution of the transaction amount column\n",
    "new_tr1[\"Amount\"].hist(bins=20)\n",
    "plt.xlabel (\"Amount\")\n",
    "plt.ylabel (\"Number of people with amount\")\n",
    "plt.title (\"Transaction Report 14-20\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 535,
   "metadata": {},
   "outputs": [],
   "source": [
    "# • Run a pivot_table on the data provided and show how performance changed on a daily and weekly basis\n",
    "# For the charts that you plot, you should stick with one colour as the colour doesn’t tell any additional information.\n",
    "# Plot the histogram and make it a decent chart size\n",
    "# Regarding the pivot_table, you can go with the intent  and adapter  columns and provide summary information\n",
    "# Like how much in each intent on a weekly basis and then the following:\n",
    "# • Sum\n",
    "# • Median\n",
    "# • Mean\n",
    "# • Count\n",
    "# • Max\n",
    "# • Min"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 536,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"6\" halign=\"left\">mean</th>\n",
       "      <th colspan=\"4\" halign=\"left\">median</th>\n",
       "      <th>...</th>\n",
       "      <th colspan=\"4\" halign=\"left\">amin</th>\n",
       "      <th colspan=\"6\" halign=\"left\">sum</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Adapter</th>\n",
       "      <th>Creditswitch</th>\n",
       "      <th>Gomoney</th>\n",
       "      <th>Nip</th>\n",
       "      <th>Postilion</th>\n",
       "      <th>Quickteller</th>\n",
       "      <th>All</th>\n",
       "      <th>Creditswitch</th>\n",
       "      <th>Gomoney</th>\n",
       "      <th>Nip</th>\n",
       "      <th>Postilion</th>\n",
       "      <th>...</th>\n",
       "      <th>Nip</th>\n",
       "      <th>Postilion</th>\n",
       "      <th>Quickteller</th>\n",
       "      <th>All</th>\n",
       "      <th>Creditswitch</th>\n",
       "      <th>Gomoney</th>\n",
       "      <th>Nip</th>\n",
       "      <th>Postilion</th>\n",
       "      <th>Quickteller</th>\n",
       "      <th>All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Intent</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Bills</th>\n",
       "      <td>556.235366</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>5902.2</td>\n",
       "      <td>714.400000</td>\n",
       "      <td>200</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>400</td>\n",
       "      <td>5.00</td>\n",
       "      <td>456113</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>147555</td>\n",
       "      <td>603668.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bills Reversal</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>200.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>200.00</td>\n",
       "      <td>0</td>\n",
       "      <td>200.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>200.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Card Creation Fee</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>850.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>850.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>850.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>850.00</td>\n",
       "      <td>0</td>\n",
       "      <td>43350.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>43350.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Card Preauth</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>5568.826261</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5568.826261</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5585532.74</td>\n",
       "      <td>0</td>\n",
       "      <td>5585532.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Card Preauth Completion</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7871.403667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7871.403667</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1800</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3542131.65</td>\n",
       "      <td>0</td>\n",
       "      <td>3542131.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Card Purchase</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>4426.708605</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4426.708605</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1450</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>15.00</td>\n",
       "      <td>0</td>\n",
       "      <td>15.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>571045.41</td>\n",
       "      <td>0</td>\n",
       "      <td>571045.41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Card Refund</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>12208.650000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>12208.650000</td>\n",
       "      <td>0</td>\n",
       "      <td>12208.65</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>11940.00</td>\n",
       "      <td>0</td>\n",
       "      <td>24417.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>24417.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fund</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>18470.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18470.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>18470.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>11940.00</td>\n",
       "      <td>0</td>\n",
       "      <td>36940.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>36940.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Instant Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>13424.663529</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13424.663529</td>\n",
       "      <td>0</td>\n",
       "      <td>500.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0</td>\n",
       "      <td>5933701.28</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>5933701.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Nip Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>17680.500000</td>\n",
       "      <td>21598.445618</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>21590.525243</td>\n",
       "      <td>0</td>\n",
       "      <td>9041.50</td>\n",
       "      <td>5008.5</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>9</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>9.00</td>\n",
       "      <td>0</td>\n",
       "      <td>106083.00</td>\n",
       "      <td>63974595.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>64080678.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Payment Link Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>125.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>125.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>100.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>100.00</td>\n",
       "      <td>0</td>\n",
       "      <td>2500.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>2500.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Payment Request</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>5975.031250</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5975.031250</td>\n",
       "      <td>0</td>\n",
       "      <td>3200.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0</td>\n",
       "      <td>95600.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>95600.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Recurring Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>0</td>\n",
       "      <td>250.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>250.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Reversal</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8539.246667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8539.246667</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>600</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.25</td>\n",
       "      <td>0</td>\n",
       "      <td>0.25</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2177507.90</td>\n",
       "      <td>0</td>\n",
       "      <td>2177507.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Scheduled Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>20500.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>20500.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>20500.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>11000.00</td>\n",
       "      <td>0</td>\n",
       "      <td>41000.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>41000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sms Fee</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.750000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.750000</td>\n",
       "      <td>0</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>2.75</td>\n",
       "      <td>0</td>\n",
       "      <td>286.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>286.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Split Transfer</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>26250.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>26250.500000</td>\n",
       "      <td>0</td>\n",
       "      <td>2250.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>500.00</td>\n",
       "      <td>0</td>\n",
       "      <td>105002.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>105002.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Withdrawal</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8083.333333</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8083.333333</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6500</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1000.00</td>\n",
       "      <td>0</td>\n",
       "      <td>1000.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>97000.00</td>\n",
       "      <td>0</td>\n",
       "      <td>97000.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>All</th>\n",
       "      <td>556.235366</td>\n",
       "      <td>9754.702412</td>\n",
       "      <td>21598.445618</td>\n",
       "      <td>6475.509843</td>\n",
       "      <td>5902.2</td>\n",
       "      <td>13142.261401</td>\n",
       "      <td>200</td>\n",
       "      <td>200.00</td>\n",
       "      <td>5008.5</td>\n",
       "      <td>1170</td>\n",
       "      <td>...</td>\n",
       "      <td>9</td>\n",
       "      <td>0.25</td>\n",
       "      <td>400</td>\n",
       "      <td>0.01</td>\n",
       "      <td>456113</td>\n",
       "      <td>6389330.08</td>\n",
       "      <td>63974595.92</td>\n",
       "      <td>11973217.70</td>\n",
       "      <td>147555</td>\n",
       "      <td>82940811.70</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                mean                                           \\\n",
       "Adapter                 Creditswitch       Gomoney           Nip    Postilion   \n",
       "Intent                                                                          \n",
       "Bills                     556.235366      0.000000      0.000000     0.000000   \n",
       "Bills Reversal              0.000000    200.000000      0.000000     0.000000   \n",
       "Card Creation Fee           0.000000    850.000000      0.000000     0.000000   \n",
       "Card Preauth                0.000000      0.000000      0.000000  5568.826261   \n",
       "Card Preauth Completion     0.000000      0.000000      0.000000  7871.403667   \n",
       "Card Purchase               0.000000      0.000000      0.000000  4426.708605   \n",
       "Card Refund                 0.000000  12208.650000      0.000000     0.000000   \n",
       "Fund                        0.000000  18470.000000      0.000000     0.000000   \n",
       "Instant Transfer            0.000000  13424.663529      0.000000     0.000000   \n",
       "Nip Transfer                0.000000  17680.500000  21598.445618     0.000000   \n",
       "Payment Link Transfer       0.000000    125.000000      0.000000     0.000000   \n",
       "Payment Request             0.000000   5975.031250      0.000000     0.000000   \n",
       "Recurring Transfer          0.000000     50.000000      0.000000     0.000000   \n",
       "Reversal                    0.000000      0.000000      0.000000  8539.246667   \n",
       "Scheduled Transfer          0.000000  20500.000000      0.000000     0.000000   \n",
       "Sms Fee                     0.000000      2.750000      0.000000     0.000000   \n",
       "Split Transfer              0.000000  26250.500000      0.000000     0.000000   \n",
       "Withdrawal                  0.000000      0.000000      0.000000  8083.333333   \n",
       "All                       556.235366   9754.702412  21598.445618  6475.509843   \n",
       "\n",
       "                                                        median            \\\n",
       "Adapter                 Quickteller           All Creditswitch   Gomoney   \n",
       "Intent                                                                     \n",
       "Bills                        5902.2    714.400000          200      0.00   \n",
       "Bills Reversal                  0.0    200.000000            0    200.00   \n",
       "Card Creation Fee               0.0    850.000000            0    850.00   \n",
       "Card Preauth                    0.0   5568.826261            0      0.00   \n",
       "Card Preauth Completion         0.0   7871.403667            0      0.00   \n",
       "Card Purchase                   0.0   4426.708605            0      0.00   \n",
       "Card Refund                     0.0  12208.650000            0  12208.65   \n",
       "Fund                            0.0  18470.000000            0  18470.00   \n",
       "Instant Transfer                0.0  13424.663529            0    500.00   \n",
       "Nip Transfer                    0.0  21590.525243            0   9041.50   \n",
       "Payment Link Transfer           0.0    125.000000            0    100.00   \n",
       "Payment Request                 0.0   5975.031250            0   3200.00   \n",
       "Recurring Transfer              0.0     50.000000            0     50.00   \n",
       "Reversal                        0.0   8539.246667            0      0.00   \n",
       "Scheduled Transfer              0.0  20500.000000            0  20500.00   \n",
       "Sms Fee                         0.0      2.750000            0      2.75   \n",
       "Split Transfer                  0.0  26250.500000            0   2250.00   \n",
       "Withdrawal                      0.0   8083.333333            0      0.00   \n",
       "All                          5902.2  13142.261401          200    200.00   \n",
       "\n",
       "                                           ... amin                        \\\n",
       "Adapter                     Nip Postilion  ...  Nip Postilion Quickteller   \n",
       "Intent                                     ...                              \n",
       "Bills                       0.0         0  ...    0      0.00         400   \n",
       "Bills Reversal              0.0         0  ...    0      0.00           0   \n",
       "Card Creation Fee           0.0         0  ...    0      0.00           0   \n",
       "Card Preauth                0.0      1000  ...    0      1.00           0   \n",
       "Card Preauth Completion     0.0      1800  ...    0      1.00           0   \n",
       "Card Purchase               0.0      1450  ...    0     15.00           0   \n",
       "Card Refund                 0.0         0  ...    0      0.00           0   \n",
       "Fund                        0.0         0  ...    0      0.00           0   \n",
       "Instant Transfer            0.0         0  ...    0      0.00           0   \n",
       "Nip Transfer             5008.5         0  ...    9      0.00           0   \n",
       "Payment Link Transfer       0.0         0  ...    0      0.00           0   \n",
       "Payment Request             0.0         0  ...    0      0.00           0   \n",
       "Recurring Transfer          0.0         0  ...    0      0.00           0   \n",
       "Reversal                    0.0       600  ...    0      0.25           0   \n",
       "Scheduled Transfer          0.0         0  ...    0      0.00           0   \n",
       "Sms Fee                     0.0         0  ...    0      0.00           0   \n",
       "Split Transfer              0.0         0  ...    0      0.00           0   \n",
       "Withdrawal                  0.0      6500  ...    0   1000.00           0   \n",
       "All                      5008.5      1170  ...    9      0.25         400   \n",
       "\n",
       "                                           sum                           \\\n",
       "Adapter                       All Creditswitch     Gomoney          Nip   \n",
       "Intent                                                                    \n",
       "Bills                        5.00       456113        0.00         0.00   \n",
       "Bills Reversal             200.00            0      200.00         0.00   \n",
       "Card Creation Fee          850.00            0    43350.00         0.00   \n",
       "Card Preauth                 1.00            0        0.00         0.00   \n",
       "Card Preauth Completion      1.00            0        0.00         0.00   \n",
       "Card Purchase               15.00            0        0.00         0.00   \n",
       "Card Refund              11940.00            0    24417.30         0.00   \n",
       "Fund                     11940.00            0    36940.00         0.00   \n",
       "Instant Transfer             0.01            0  5933701.28         0.00   \n",
       "Nip Transfer                 9.00            0   106083.00  63974595.92   \n",
       "Payment Link Transfer      100.00            0     2500.00         0.00   \n",
       "Payment Request              0.50            0    95600.50         0.00   \n",
       "Recurring Transfer          50.00            0      250.00         0.00   \n",
       "Reversal                     0.25            0        0.00         0.00   \n",
       "Scheduled Transfer       11000.00            0    41000.00         0.00   \n",
       "Sms Fee                      2.75            0      286.00         0.00   \n",
       "Split Transfer             500.00            0   105002.00         0.00   \n",
       "Withdrawal                1000.00            0        0.00         0.00   \n",
       "All                          0.01       456113  6389330.08  63974595.92   \n",
       "\n",
       "                                                               \n",
       "Adapter                    Postilion Quickteller          All  \n",
       "Intent                                                         \n",
       "Bills                           0.00      147555    603668.00  \n",
       "Bills Reversal                  0.00           0       200.00  \n",
       "Card Creation Fee               0.00           0     43350.00  \n",
       "Card Preauth              5585532.74           0   5585532.74  \n",
       "Card Preauth Completion   3542131.65           0   3542131.65  \n",
       "Card Purchase              571045.41           0    571045.41  \n",
       "Card Refund                     0.00           0     24417.30  \n",
       "Fund                            0.00           0     36940.00  \n",
       "Instant Transfer                0.00           0   5933701.28  \n",
       "Nip Transfer                    0.00           0  64080678.92  \n",
       "Payment Link Transfer           0.00           0      2500.00  \n",
       "Payment Request                 0.00           0     95600.50  \n",
       "Recurring Transfer              0.00           0       250.00  \n",
       "Reversal                  2177507.90           0   2177507.90  \n",
       "Scheduled Transfer              0.00           0     41000.00  \n",
       "Sms Fee                         0.00           0       286.00  \n",
       "Split Transfer                  0.00           0    105002.00  \n",
       "Withdrawal                  97000.00           0     97000.00  \n",
       "All                      11973217.70      147555  82940811.70  \n",
       "\n",
       "[19 rows x 30 columns]"
      ]
     },
     "execution_count": 536,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_tr1.pivot_tabl e(values = \"Amount\", index = \"Intent\", columns = \"Adapter\", fill_value = 0, margins = True,\n",
    "                                        aggfunc = [np.mean, np.median, np.max, np.min, np.sum])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 515,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Nip             2962\n",
       "Postilion       1849\n",
       "Creditswitch     820\n",
       "Gomoney          655\n",
       "Quickteller       25\n",
       "Name: Adapter, dtype: int64"
      ]
     },
     "execution_count": 515,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_tr1[\"Adapter\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 516,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Nip Transfer               2968\n",
       "Card Preauth               1003\n",
       "Bills                       845\n",
       "Card Preauth Completion     450\n",
       "Instant Transfer            442\n",
       "Reversal                    255\n",
       "Card Purchase               129\n",
       "Sms Fee                     104\n",
       "Card Creation Fee            51\n",
       "Payment Link Transfer        20\n",
       "Payment Request              16\n",
       "Withdrawal                   12\n",
       "Recurring Transfer            5\n",
       "Split Transfer                4\n",
       "Fund                          2\n",
       "Scheduled Transfer            2\n",
       "Card Refund                   2\n",
       "Bills Reversal                1\n",
       "Name: Intent, dtype: int64"
      ]
     },
     "execution_count": 516,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_tr1[\"Intent\"].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
